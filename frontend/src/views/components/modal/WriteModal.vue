<template>
  <b-modal
    id="write-modal"
    size="lg"
    centered
    scrollable
    no-close-on-esc
    no-close-on-backdrop
    v-model="modalShow"
  >
    <!-- 모달 header -->
    <template #modal-header>
      <b-button variant="light" size="sm" class="post-button">
        등록
      </b-button>
      <div class="title-wraper">
        <span class="mx-auto modal-title text-center write-modal-title">
          글쓰기
        </span>
      </div>
      <button type="button" aria-label="Close" class="close" @click="close()">
        ×
      </button>
    </template>

    <!-- 모달 content  -->
    <el-collapse v-model="activeNames" @change="handleCategori">
      <el-collapse-item name="categori">
        <!-- 선택된 카테고리  -->
        <template slot="title">
          {{ categoriName }}
        </template>
        <!-- 카테고리 목록 -->
        <b-list-group v-if="isShowCategori">
          <b-list-group-item
            v-for="(cardTitle, index) in cardTitles"
            :key="index"
            class="d-flex justify-content-between align-items-center"
            @click="clickCategori(index)"
          >
            {{ cardTitle.emoticon }}
            {{ cardTitle.title }}
          </b-list-group-item>
        </b-list-group>
      </el-collapse-item>
    </el-collapse>
    <!-- 제목 입력 -->
    <b-input
      class="mt-3"
      size="lg"
      v-model="title"
      placeholder="제목을 입력해주세요"
    ></b-input>
    <!-- 내용 입력 -->
    <b-form-textarea
      class="mt-3"
      id="textarea-rows"
      :placeholder="contentPlaceholder"
      rows="8"
      no-resize
      v-model="content"
    ></b-form-textarea>

    <!-- 모달 하단 -->
    <template #modal-footer>
        <div class="w-100">
          <p class="float-left">
            <span class="">📷</span>
          </p>
          <b-button
            variant="primary"
            size="sm"
            class="float-right"
            @click="show=false"
          >
            Close
          </b-button>
        </div>
      </template>
  </b-modal>
</template>

<script>
import cardTitles from '@/constant/index';

export default {
  name: 'LoginModal',
  data() {
    return {
      modalShow: false,
      activeNames: [],
      categoriName: '카테고리',
      cardTitles,
      isShowCategori: false,
      title: '',
      content: '',
      contentPlaceholder:
        '주제에 맞지 않는 글로 판단되어 다른 유저들로 부터 일정 수 이상의 신고를 받는 경우 글이 자동으로 숨김처리 될 수 있습니다.',
    };
  },
  watch: {
    title: {
      immediate: true,
      handler() {
        if (this.content !== null) {
          this.title == '';
        }
      },
    },
    content: {
      immediate: true,
      handler() {
        if (this.content !== null) {
          this.content == '';
        }
      },
    },
  },
  methods: {
    // 모달 창 닫기 => 선택된 카테고리 초기화
    close() {
      this.modalShow = false;
      this.activeNames = [];
      this.categoriName = '카테고리';
    },
    // 카테고리 목록 보이기
    handleCategori() {
      this.isShowCategori = true;
    },
    // 카테고리 클릭 => 선택된 카테고리를 collapse 타이틀로
    clickCategori(index) {
      this.isShowCategori = false;
      this.activeNames = [];
      this.categoriName =
        this.cardTitles[index].emoticon + this.cardTitles[index].title;
    },
  },
};
</script>

<style lang="scss" scoped>
@import '@/assets/scss/components/writemodal.scss';
</style>
